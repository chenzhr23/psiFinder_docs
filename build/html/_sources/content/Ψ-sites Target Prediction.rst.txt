Ψ-sites Target Prediction
===========================

.. contents::
    :local:

We developed a core C program--``ACAscan``, for Ψ-sites target prediction.

.. image:: /images/snoRNA_target_prediction.png

Input
------
Users should choose to upload files (i.e. rtsSeeker result) in bed format, corresponding annotation file of the bed file (with `_anno.bed` sufffix), and snoRNA dataset ``human_hg38_snoRNABase_snoDB_rmRepeat.fa``, to predict snoRNA-(Ψ)target interaction.

.. code:: bash

    Usage:  ACAscan [options] -f <fasta file> -m <modified file>
    [options]
    -f/--fa<file>          : sequence file<FASTA format>
    -m/--mod<file>         : modified file
    -o/--output <file>     : output file
    -v/--verbose           : verbose information
    -V/--version           : ACAscan version
    -h/--help              : help informations
    -s/--struct-score      : minimum score for hairpin-Hbox-hairpin-ACAbox[default=5.0]
    -t/--target-score      : minimum score for snoRNA-target duplex[default=13.5]

Predict Ψ-sites target
---------------------------------------------
Once click ``START``, psiFindeer will run ``5_ACA_scan.sh``.


snoRNA sequence
********************
``-f`` option requires snoRNA sequence file in fasta format, default psiFinder provide built-in snoRNA dataset ``human_hg38_snoRNABase_snoDB_rmRepeat.fa``

Modified file
**********************
``-m`` option accept a three column file (with ``_pseudoU.sites`` suffix, generated by ``5_ACA_scan.sh``) like below (genome_location snoRNA_info target_sequence)

.. code:: bash

    chr1_10298995_10298996_+        U6-31-ACA65     GCACAUAUACUAAAAYUGGAACGAUACAGAG
    chr1_10299004_10299005_+        U6-40-HBI-100/ACA12     CUAAAAUUGGAACGAYACAGAGAAGAUUAGC
    chr1_11908193_11908194_+        U5-43-ACA57     AAAUCUUUCGCCUUUYACUAAAGAUUUCCGU
    chr1_44731124_44731125_-        U5-46-U85/U89   UCUUUCGCCUUUUACYAAAGAUUUCCGUGGA
    chr1_92700930_92700931_-        U4-4-SCARNA27   AGCYUUGCGCAGUGGCAGU
    chr1_109591554_109591555_-      U6-86-ACA65     GGAUGACACGCAAAUYCGUGAAGCGUUCCAU
    chr1_145465775_145465776_-      U1-5-ACA47      AUACYUACCUGGCAGGGGAG
    chr1_148522605_148522606_+      U1-6-ACA47/U109 AUACUYACCUGGCAGGGGAGA
    chr11_62841749_62841750_-       U2-60-unknown   CUUAUCAGUUUAAUAYCUGAUACGUCCUCUA
    chr11_62841751_62841752_-       U2-58-unknown   UUCUUAUCAGUUUAAYAUCUGAUACGUCCUC


Output
--------
Result with ``_pseudoU_high_confidence.csv`` suffix is the final target prediction result, which is a filter result of ``_pseudoU.csv`` (filter by ``Modified_score>=15 & PairNum>=9 & total_UnPair<=2``).

.. code:: bash

    $ cd /the/directory/of/out_file_dir

    # see all files, don't run.
    $ tree -L 1
    .
    ├── Day0_common_rep1_anno.bed
    ├── Day0_common_rep1_anno.bed6
    ├── Day0_common_rep1_anno.bed6.append
    ├── Day0_common_rep1_anno_info.bed
    ├── Day0_common_rep1.bed
    ├── Day0_common_rep1_fa.out
    ├── Day0_common_rep1.known.target
    ├── Day0_common_rep1_pseudoU.csv
    ├── Day0_common_rep1_pseudoU_high_confidence.csv
    ├── Day0_common_rep1_pseudoU_high_confidence.pdf
    ├── Day0_common_rep1_pseudoU_high_confidence_snoRNA_guided_RNA_piechart.pdf
    ├── Day0_common_rep1_pseudoU_high_confidence.txt
    ├── Day0_common_rep1_pseudoU_high_confidence.xlsx
    ├── Day0_common_rep1_pseudoU_Orphan_piechart.pdf
    ├── Day0_common_rep1_pseudoU.pdf
    ├── Day0_common_rep1_pseudoU.sites
    ├── Day0_common_rep1_pseudoU.txt
    ├── Day0_common_rep1_pseudoU.xlsx
    └── Day0_common_rep1.unknown.target

    0 directory, 19 files


.. note:: All user input will be recorded in a plain text file with suffix ``_ACAscan_config.txt`` in psiFinder/config and help users to easily reload the previous config (by simply clicking ``CONFIG`` button).
