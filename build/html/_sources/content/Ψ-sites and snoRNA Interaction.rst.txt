Ψ-sites and snoRNA Interaction
====================================

.. contents::
    :local:

psiFinder ``Ψ-sites and snoRNA Interaction`` was developed for visualization of interaction between Ψ-sites and snoRNA targets.

.. image:: /images/snoRNA_target_interaction.png

Input
------
Users should choose to upload result file generated (``_pseudoU.csv`` or ``_pseudoU_high_confidence.csv``) from ``Ψ-sites Target Prediction`` to visualize snoRNA-(Ψ)target interaction.

Visualize Ψ-sites and snoRNA target interaction
----------------------------------------------------
Once click ``START``, psiFindeer ``snoTar`` QT widget will respond and run ``snoTarDuplex.sh``.

``snoTarDuplex.sh``

.. code:: bash

    #!/bin/bash
    Help() {
    echo
    "snoTarDuplex.sh example:
     bash snoTarDuplex.sh -c snoTarDuplex command -o out_dir -p prefix -s sequence -d app_dir
    "
    }


    usage() {                                      # Function: Print a help message.
      echo "Usage: $0 [ -h help] [ -c cmd ] [ -o out_dir ] [ -p prefix ] [ -s sequence ] [ -d app_dir ]" 1>&2
    }
    exit_abnormal() {                              # Function: Exit with error.
      usage
      exit 1
    }


    while getopts ":h:c:o:p:s:d:" options; do

      case "${options}" in
        h|:)
          usage
          Help
          exit 0
          ;;
        c)
          cmd=${OPTARG}
          if ! [[ -n $cmd ]] ; then
            echo "You didn't input the cmd"
          fi
          ;;
        o)
          out_dir=${OPTARG}
          if ! [[ -n $out_dir ]] ; then
            echo "You didn't input the out_dir"
          fi
          ;;
        p)
          prefix=${OPTARG}
          if ! [[ -n $prefix ]] ; then
            echo "You didn't input the prefix"
          fi
          ;;
        s)
          seq=${OPTARG}
          if ! [[ -n $seq ]] ; then
            echo "You didn't input the structure sequence"
          fi
          ;;
        d)
          app_dir=${OPTARG}
          if ! [[ -n $app_dir ]] ; then
            echo "You didn't input the app_dir"
          fi
          ;;
        \?) # incorrect option
          echo "Error: -${OPTARG} Invalid option"
          exit_abnormal
          ;;
      esac
    done

    shift $(($OPTIND - 1))

    eval $cmd &
    wait

    mv ${app_dir}/${prefix}* ${out_dir}
    echo -e "All results in ${out_dir} with prefix ${prefix}"

    exit 0  # Exit normally.

Button ``PREVIOUS`` and ``NEXT`` help to check interaction diagram one by one. ``SEARCH`` help to respond when users want to view specific id of interaction with ``Ranked number of target score``.

For saving interaction diagram in batch, users can press button ``BATCH SEARCH``.

Output
--------

Information
**************

Basic interaction information was showed in the left panel of the ``snoTar`` QT widget.

Diagram
********

Interaction diagram was showed in the right panel of the ``snoTar`` QT widget. Bottom right is the secondary structure of the target sequence (generated by `RNAfold <https://www.tbi.univie.ac.at/RNA/RNAfold.1.html>`_ software).

File with suffix ``_ACAscan_*.pdf`` is a interaction graphical summary of snoRNAs guided Ψ-modified targets.

Below is the ``BATCH SEARCH`` interaction diagram output from input ``ACAscan`` result.

.. image:: /images/snoRNA_target_visualization_output_summary.png

.. image:: /images/snoRNA_target_visualization_output_example.png
