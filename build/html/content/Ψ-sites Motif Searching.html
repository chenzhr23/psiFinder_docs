
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Ψ-sites Motif Searching &#8212; psiFinder v1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ψ-sites SNPs and SNVs Searching" href="%CE%A8-sites%20SNPs%20and%20SNVs%20Searching.html" />
    <link rel="prev" title="Ψ-sites and snoRNA Interaction" href="%CE%A8-sites%20and%20snoRNA%20Interaction.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>psiFinder v1.0 documentation</span></a></h1>
        <h2 class="heading"><span>Ψ-sites Motif Searching</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="%CE%A8-sites%20and%20snoRNA%20Interaction.html">Ψ-sites and snoRNA Interaction</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="%CE%A8-sites%20SNPs%20and%20SNVs%20Searching.html">Ψ-sites SNPs and SNVs Searching</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="sites-motif-searching">
<h1>Ψ-sites Motif Searching<a class="headerlink" href="#sites-motif-searching" title="Permalink to this heading">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#input" id="id1">Input</a></p></li>
<li><p><a class="reference internal" href="#search-sites-motif" id="id2">Search Ψ-sites Motif</a></p></li>
<li><p><a class="reference internal" href="#output" id="id3">Output</a></p>
<ul>
<li><p><a class="reference internal" href="#information" id="id4">Information</a></p></li>
<li><p><a class="reference internal" href="#diagram" id="id5">Diagram</a></p></li>
</ul>
</li>
</ul>
</div>
<p>psiFinder <code class="docutils literal notranslate"><span class="pre">Ψ-sites</span> <span class="pre">Motif</span> <span class="pre">Searching</span></code> utilize <a class="reference external" href="http://homer.ucsd.edu/homer/motif/">HOMER</a> to generate motif searching result for Ψ-sites.</p>
<img alt="../_images/Motif_Searching.png" src="../_images/Motif_Searching.png" />
<section id="input">
<h2><a class="toc-backref" href="#id1">Input</a><a class="headerlink" href="#input" title="Permalink to this heading">¶</a></h2>
<p>Users should choose to upload files (i.e. rtsSeeker result) to <code class="docutils literal notranslate"><span class="pre">findMoitf</span></code> QT widget in bed format and genome fasta file.</p>
</section>
<section id="search-sites-motif">
<h2><a class="toc-backref" href="#id2">Search Ψ-sites Motif</a><a class="headerlink" href="#search-sites-motif" title="Permalink to this heading">¶</a></h2>
<p>Once click <code class="docutils literal notranslate"><span class="pre">START</span></code>, psiFindeer will run <code class="docutils literal notranslate"><span class="pre">findMotif.sh</span></code> and <code class="docutils literal notranslate"><span class="pre">findMotifsGenome.r</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">findMotif.sh</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /bin/bash</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s1">&#39;Usage: ./&#39;</span><span class="nv">$0</span> <span class="s1">&#39; bedfile genome&#39;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>

<span class="nv">bedfile</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">genome</span><span class="o">=</span><span class="nv">$2</span>


awk <span class="s1">&#39;FS=OFS=&quot;\t&quot; {print $1,$2-10,$3+10,&quot;&quot;$1&quot;_&quot;$2&quot;_&quot;$3&quot;_&quot;$6&quot;&quot;,$5,$6}&#39;</span> <span class="si">${</span><span class="nv">bedfile</span><span class="si">}</span> &gt;<span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_win21.bed
<span class="nb">echo</span> <span class="s2">&quot;clearing previous Motif result&quot;</span>
rm -rf <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif

<span class="nb">echo</span> <span class="s2">&quot;finding Motif for current task&quot;</span>
findMotifsGenome.pl <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_win21.bed <span class="nv">$genome</span> <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif -size given -rna <span class="m">2</span>&gt;<span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif.log
Rscript script/findMotifsGenome.r -f <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif/homerResults/
wkhtmltopdf -s A2 <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif/homerResults.html <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif/homerResults.pdf <span class="p">&amp;</span>&gt; /dev/null
mupdf-x11 <span class="si">${</span><span class="nv">bedfile</span><span class="p">%.bed</span><span class="si">}</span>_motif/homerResults.pdf <span class="p">&amp;</span>&gt; /dev/null

<span class="nb">echo</span> -e <span class="s2">&quot;Finished: findMotif done!\n&quot;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;findMotif result in </span><span class="k">$(</span>dirname <span class="si">${</span><span class="nv">bedfile</span><span class="si">}</span><span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">findMotifsGenome.r</span></code></p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1">#!/usr/bin/env Rscript</span>

<span class="nf">suppressMessages</span><span class="p">(</span>    <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="s">&#39;motifStack&#39;</span><span class="p">))</span> <span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;motifStack&#39;</span><span class="p">);</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;motifStack&quot;</span><span class="p">))</span>

<span class="n">option_list</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span>
  <span class="nf">make_option</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--filepath&quot;</span><span class="p">),</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;character&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">NULL</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s">&quot;filepath [file]&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s">&quot;character&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="n">opt_parser</span> <span class="o">=</span> <span class="nf">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">option_list</span><span class="p">);</span>
<span class="n">opt</span> <span class="o">=</span> <span class="nf">parse_args</span><span class="p">(</span><span class="n">opt_parser</span><span class="p">);</span>


<span class="nf">if </span><span class="p">(</span><span class="nf">is.null</span><span class="p">(</span><span class="n">opt</span><span class="o">$</span><span class="n">filepath</span><span class="p">)){</span>
  <span class="nf">print_help</span><span class="p">(</span><span class="n">opt_parser</span><span class="p">);</span>
  <span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Please provide -f filepath&quot;</span><span class="p">,</span> <span class="n">call.</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">filepath</span> <span class="o">=</span> <span class="n">opt</span><span class="o">$</span><span class="n">filepath</span>
<span class="n">outFile_prefix</span> <span class="o">=</span> <span class="n">opt</span><span class="o">$</span><span class="n">outfile_prefix</span>

<span class="nf">print</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

<span class="n">files</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">list.files</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;motif[0-9]*.motif$&quot;</span><span class="p">))</span>
<span class="n">motiffile</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">()</span>
<span class="c1"># invisible(lapply(1:10,function(i){motiffile[[i]]&lt;&lt;-read.table(paste(filepath,&quot;motif&quot;,i,&quot;.motif&quot;,sep=&quot;&quot;),header=F,skip=1)}))</span>
<span class="nf">invisible</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span><span class="nf">seq_along</span><span class="p">(</span><span class="n">files</span><span class="p">),</span><span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">){</span><span class="n">motiffile</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">&lt;&lt;-</span><span class="nf">read.table</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="s">&quot;motif&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s">&quot;.motif&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="m">1</span><span class="p">)}))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">motiffile</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Ranked_Motif&quot;</span><span class="p">,</span><span class="nf">seq_along</span><span class="p">(</span><span class="n">files</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="nf">invisible</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span><span class="nf">seq_along</span><span class="p">(</span><span class="n">files</span><span class="p">),</span><span class="nf">function</span><span class="p">(</span><span class="n">j</span><span class="p">){</span>
        <span class="nf">names</span><span class="p">(</span><span class="n">motiffile</span><span class="p">[[</span><span class="n">j</span><span class="p">]])</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="s">&quot;G&quot;</span><span class="p">,</span><span class="s">&quot;U&quot;</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">&lt;-</span> <span class="n">motiffile</span><span class="p">[[</span><span class="n">j</span><span class="p">]][,</span><span class="m">1</span><span class="p">]</span>
        <span class="n">C</span> <span class="o">&lt;-</span> <span class="n">motiffile</span><span class="p">[[</span><span class="n">j</span><span class="p">]][,</span><span class="m">2</span><span class="p">]</span>
        <span class="n">G</span> <span class="o">&lt;-</span> <span class="n">motiffile</span><span class="p">[[</span><span class="n">j</span><span class="p">]][,</span><span class="m">3</span><span class="p">]</span>
        <span class="n">U</span> <span class="o">&lt;-</span> <span class="n">motiffile</span><span class="p">[[</span><span class="n">j</span><span class="p">]][,</span><span class="m">4</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">U</span><span class="p">)</span>
        <span class="n">pcm</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="nf">ncol</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>
        <span class="nf">rownames</span><span class="p">(</span><span class="n">pcm</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="s">&quot;G&quot;</span><span class="p">,</span><span class="s">&quot;U&quot;</span><span class="p">)</span>
        <span class="n">motif</span> <span class="o">&lt;-</span> <span class="nf">new</span><span class="p">(</span><span class="s">&quot;pcm&quot;</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">pcm</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="nf">names</span><span class="p">(</span><span class="n">motiffile</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="nf">pdf.options</span><span class="p">(</span><span class="n">reset</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">onefile</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
        <span class="nf">pdf</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="nf">names</span><span class="p">(</span><span class="n">motiffile</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span><span class="s">&quot;.pdf&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">),</span><span class="n">height</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>
        <span class="nf">plot</span><span class="p">(</span><span class="n">motif</span><span class="p">)</span>
        <span class="nf">invisible</span><span class="p">(</span><span class="nf">dev.off</span><span class="p">()</span> <span class="p">)</span>
<span class="p">}))</span>
</pre></div>
</div>
</section>
<section id="output">
<h2><a class="toc-backref" href="#id3">Output</a><a class="headerlink" href="#output" title="Permalink to this heading">¶</a></h2>
<section id="information">
<h3><a class="toc-backref" href="#id4">Information</a><a class="headerlink" href="#information" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /the/directory/of/out_file_dir
$ tree -L <span class="m">1</span>
.
├── Day0_Day4_common.bed
├── Day0_Day4_common_motif
├── Day0_Day4_common_motif.log
└── Day0_Day4_common_win21.bed

<span class="m">1</span> directory, <span class="m">3</span> files
</pre></div>
</div>
</section>
<section id="diagram">
<h3><a class="toc-backref" href="#id5">Diagram</a><a class="headerlink" href="#diagram" title="Permalink to this heading">¶</a></h3>
<p>File <code class="docutils literal notranslate"><span class="pre">homerResults.pdf</span></code> (in a directory which named by the prefix of the input rtsSeeker bed file) is a motif enrichment report of Ψ-sites motif on input Ψ-sites. Corresponding file with pattern <code class="docutils literal notranslate"><span class="pre">Ranked_Motif*.pdf</span></code> in <code class="docutils literal notranslate"><span class="pre">homerResults/</span></code> save all the motif diagram.</p>
<img alt="../_images/homerResults.png" src="../_images/homerResults.png" />
<img alt="../_images/homerResults_output.png" src="../_images/homerResults_output.png" />
<img alt="../_images/homerResults_demo.png" src="../_images/homerResults_demo.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All user input will be recorded in a plain text file with suffix <code class="docutils literal notranslate"><span class="pre">_findMotif_config.txt</span></code> in psiFinder/config and help users to easily reload the previous config (by simply clicking <code class="docutils literal notranslate"><span class="pre">CONFIG</span></code> button).</p>
</div>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="%CE%A8-sites%20and%20snoRNA%20Interaction.html">Ψ-sites and snoRNA Interaction</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="%CE%A8-sites%20SNPs%20and%20SNVs%20Searching.html">Ψ-sites SNPs and SNVs Searching</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, chenzhr23.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>